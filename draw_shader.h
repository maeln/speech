/* File generated with Shader Minifier 1.1.6
 * http://www.ctrl-alt-test.fr
 */
#ifndef DRAW_SHADER_H_
# define DRAW_SHADER_H_
# define VAR_IRESOLUTION "v"
# define VAR_ITIME "m"

const char *draw_frag =
 "#version 430\n"
 "layout(location=0)uniform vec4 v;"
 "layout(location=1)uniform int m;\n"
 "#define PI 3.1415\n"
 "#define MAXSTEPS 128\n"
 "#define MINDIST 0.0001\n"
 "#define MAXDIST 20.0\n"
 "#define saturate(x)(clamp(0.0,1.0,x))\n"
 "#define f1(x)(clamp(x,0.0,1.0))\n"
 "#define rep(p,r)(mod(p-r*.5,r)-r*.5)\n"
 "vec3 f=vec3(0.,0.,0.)/255.,x=vec3(0.,0.,0.)/255.;"
 "float y=float(m)/1000.;struct pLight{vec3 position;vec3 ambiant;vec3 diffuse;vec3 specular;};"
 "float t(in vec2 v)"
 "{"
   "return fract(sin(dot(v.xy,vec2(12.9898,78.233)))*43758.5);"
 "}"
 "mat4 t(vec3 v,float y)"
 "{"
   "v=normalize(v);"
   "float x=sin(y),f=cos(y),m=1.-f;"
   "return mat4(m*v.x*v.x+f,m*v.x*v.y-v.z*x,m*v.z*v.x+v.y*x,0.,m*v.x*v.y+v.z*x,m*v.y*v.y+f,m*v.y*v.z-v.x*x,0.,m*v.z*v.x-v.y*x,m*v.y*v.z+v.x*x,m*v.z*v.z+f,0.,0.,0.,0.,1.);"
 "}"
 "float t(float v,float y,float x)"
 "{"
   "float m=clamp(.5+.5*(y-v)/x,0.,1.);"
   "return mix(y,v,m)-x*m*(1.-m);"
 "}"
 "float n(vec3 v,vec3 x,float y)"
 "{"
   "v=abs(v)-x;"
   "vec3 m=abs(v+y)-y;"
   "return min(min(length(max(vec3(v.x,m.y,m.z),0.))+min(max(v.x,max(m.y,m.z)),0.),length(max(vec3(m.x,v.y,m.z),0.))+min(max(m.x,max(v.y,m.z)),0.)),length(max(vec3(m.x,m.y,v.z),0.))+min(max(m.x,max(m.y,v.z)),0.));"
 "}"
 "float n(vec3 v,float y)"
 "{"
   "return length(v)-y;"
 "}"
 "float n(vec3 v,vec3 x,vec3 y,float m)"
 "{"
   "vec3 f=v-x,c=y-x;"
   "float z=clamp(dot(f,c)/dot(c,c),0.,1.);"
   "return length(f-c*z)-m;"
 "}"
 "float s(vec2 v,float y)"
 "{"
   "return length(v)-y;"
 "}"
 "float n(in vec2 v,in vec2 m,in vec2 y,in float x,in float z)"
 "{"
   "v*=mat2(m.x,m.y,-m.y,m.x);"
   "v.x=abs(v.x);"
   "float f=y.y*v.x>y.x*v.y?dot(v.xy,y):length(v);"
   "return sqrt(max(0.,dot(v,v)+x*x-2.*x*f))-z;"
 "}"
 "vec3 n(int v)"
 "{"
   "float m=float(v),x=sin(m/4.+y)+mix(2.,0.,f1(y-4.)),f=sin(2.*PI*(m/10.)+y)-mix(0.,sin(2.*PI*(m/10.)+y),f1(y/1.5-20.)),c=cos(2.*PI*(m/10.)+y)-mix(0.,cos(2.*PI*(m/10.)+y),f1(y/1.5-20.));"
   "vec3 n=vec3(x,f,c),s=n;"
   "return s;"
 "}"
 "float s(vec3 v)"
 "{"
   "vec3 x=vec3(0.),f=vec3(0.,0.,1.),m=vec3(0.,sqrt(1.),.5);"
   "return min(min(n(v,x,f,.01),n(v,f,m,.01)),n(v,m,x,.01));"
 "}"
 "vec2 p(vec3 v)"
 "{"
   "float m=0.,x=MAXDIST;"
   "for(int f=1;f<50;++f)"
     "{"
       "float n=float(f),c=2.-t(vec2(n,5.))*4.,i=2.-t(vec2(n,2.))*4.,l=-10.+mix(n/50.*10.,0.,saturate(y/20.))+mod(y*2.+t(vec2(n,1.))*20.,20.);"
       "vec3 r=v-vec3(l,i,c);"
       "float p=2.-t(vec2(n,5.))*4.;"
       "r=(t(vec3(p,i,c),y)*vec4(r,1.)).xyz;"
       "float z=s(r);"
       "if(x>z)"
         "x=z,m=n;"
     "}"
   "return vec2(x,m);"
 "}"
 "vec2 e(vec3 v)"
 "{"
   "float m=0.,x=MAXDIST;"
   "for(int y=0;y<10;++y)"
     "{"
       "float f=n(v-n(y),.1);"
       "if(x>f)"
         "x=f,m=float(y)+1.;"
     "}"
   "return vec2(x,m);"
 "}"
 "float M(vec3 v)"
 "{"
   "float m=2.-t(vec2(7.,5.))*4.,x=2.-t(vec2(2.,2.))*4.,f=2.-t(vec2(16.,5.))*4.;"
   "vec3 r=v;"
   "r=(t(vec3(f,x,m),y)*vec4(v,1.)).xyz;"
   "return n(r,vec3(.2,.2,.2)*vec3(f1(y/1.5-29./1.5)),.025);"
 "}"
 "vec3 c(vec3 v)"
 "{"
   "vec2 m=p(v),f=e(v);"
   "float x=M(v),c=t(f.x,x,.1),i=m.y,r=m.x,z=0.;"
   "if(f.x<m.x)"
     "i=f.y,r=f.x,z=1.;"
   "if(y>25.&&x<r)"
     "r=x,z=1.;"
   "return vec3(r,i,z);"
 "}"
 "vec3 h(vec3 v)"
 "{"
   "vec2 m=vec2(0.,MINDIST);"
   "return normalize(vec3(c(v+m.yxx).x-c(v-m.yxx).x,c(v+m.xyx).x-c(v-m.xyx).x,c(v+m.xxy).x-c(v-m.xxy).x));"
 "}"
 "vec4 M(vec3 v,vec3 y)"
 "{"
   "float m=MINDIST;"
   "int x=0;"
   "vec3 f=vec3(MAXDIST,-1.,-1.);"
   "for(int r=0;r<MAXSTEPS;++r)"
     "{"
       "++x;"
       "f=c(v+m*y);"
       "if(f.x<MINDIST||m>=MAXDIST)"
         "break;"
       "m+=f.x;"
     "}"
   "return vec4(m,m>MAXDIST?-1.:f.y,f.z,float(x));"
 "}"
 "vec3 M(vec3 v,vec3 x,vec3 m,pLight y,float f)"
 "{"
   "vec3 r=normalize(y.position-v),c=normalize(x-v),i=reflect(r,m),z=y.ambiant,s=max(dot(r,m),0.)*y.diffuse,n=pow(max(dot(i,c),0.),f)*y.specular;"
   "return z+.5*(s+n);"
 "}"
 "void main()"
 "{"
   "pLight m=pLight(vec3(sin(y/3.),sin(y/4.),cos(y/6.)),vec3(0.),vec3(0.),vec3(1.8));"
   "vec2 r=(2.*gl_FragCoord.xy-v.xy)/v.y;"
   "vec3 c=vec3(0.,0.,0.),z=vec3(2.,0.,0.),i=vec3(0.,1.,0.),l=normalize(c-z),p=normalize(cross(i,z)),I=normalize(cross(z,p)),P=normalize(p*r.x+I*r.y+l),a=mix(x,f,gl_FragCoord.y/v.y),d=a;"
   "vec4 t=M(z,P);"
   "d=vec3(.3,0.,1.)*t.w/float(MAXSTEPS)*4.;"
   "if(t.y>0.)"
     "{"
       "d=vec3(1.);"
       "if(t.z>0.)"
         "{"
           "vec3 T=z+t.x*P,e=h(T);"
           "d*=M(T,z,e,m,16.);"
         "}"
     "}"
   "float T=s(r+vec2(.5,.5),.1);"
   "d=mix(d,vec3(1.),smoothstep(3./v.y,0.,T));"
   "float e=PI/2.*y*2.,g=PI/4.*(1.-sin(y)/2.);"
   "T=n(r+vec2(.5,.5),vec2(sin(e),cos(e)),vec2(sin(g),cos(g)),.2,.02);"
   "d=mix(d,vec3(1.),smoothstep(4./v.y,0.,T));"
   "gl_FragColor=vec4(d,1.);"
 "}";

#endif // DRAW_SHADER_H_
